<base:PanelBase 
    x:Class="Scheduler.Plugin.SchedulerPanel"
    xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
    xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
    xmlns:mc="http://schemas.openxmlformats.org/markup-compatibility/2006" 
    xmlns:d="http://schemas.microsoft.com/expression/blend/2008" 
    xmlns:local="clr-namespace:Scheduler.Plugin"
    xmlns:base="clr-namespace:Client.Base;assembly=Client.Base"
    xmlns:controls="clr-namespace:Client.Controls;assembly=Client.Controls"
    mc:Ignorable="d" 
    d:DesignHeight="300" d:DesignWidth="300">
    <Grid>
        <Grid.RowDefinitions>
            <RowDefinition Height="auto"/>
            <RowDefinition Height="*"/>
        </Grid.RowDefinitions>
        <DataGrid Grid.Row ="1" ItemsSource="{Binding Path=Jobs}" IsReadOnly="true" SelectionMode="Extended" controls:MultiSelect.IsEnabled="true" AutoGenerateColumns="False" HeadersVisibility="Column">
            <DataGrid.Columns>
                <DataGridTextColumn Binding="{Binding Path=Job.Name}" Header="Name" Width="auto"/>
                <DataGridTextColumn Binding="{Binding Path=Job.Site}" Header="Site" Width="auto"/>
                <DataGridTextColumn Binding="{Binding Path=Type}" Header="Name" Width="auto"/>
                <DataGridTextColumn Binding="{Binding Path=Job.RunState}" Header="Startup" Width="auto"/>
                <DataGridTextColumn Binding="{Binding Path=State.Status}" Header="State" Width="auto"/>
                <DataGridTextColumn Binding="{Binding Path=State.NextRunTime}" Header="Next Run" Width="auto"/>
                <DataGridTextColumn Binding="{Binding Path=State.LastRunDuration,StringFormat=\{0:h\\:mm\\:ss\}}" Header="Last Run" Width="auto"/>
                <DataGridTextColumn Binding="{Binding Path=State.Statistics.TotalItems}" Header="Items" Width="auto"/>
                <DataGridTextColumn Binding="{Binding Path=State.Statistics.Completed}" Header="Completed" Width="auto"/>
                <DataGridTextColumn Binding="{Binding Path=State.Statistics.Saved}" Header="Saved" Width="auto"/>
                <DataGridTextColumn Binding="{Binding Path=State.Statistics.Skipped}" Header="Skipped" Width="auto"/>
                <DataGridTextColumn Binding="{Binding Path=State.Statistics.Errors}" Header="Errors" Width="auto"/>
                <!--<DataGridTemplateColumn  Header="Status" Width="auto">
                    <DataGridTemplateColumn.CellTemplate>
                        <DataTemplate>
                            <TextBlock Text="{Binding Path=State.Statistics.Completed}"/>
                        </DataTemplate>
                    </DataGridTemplateColumn.CellTemplate>
                </DataGridTemplateColumn>-->
            </DataGrid.Columns>
            <DataGrid.ItemContainerStyle>
                <Style TargetType="DataGridRow">
                    <Setter Property="ContextMenu">
                        <Setter.Value>
                            <ContextMenu>
                                <MenuItem Command="{Binding RunJobCommand}" Header="Run Selected Jobs"/>
                                <MenuItem Command="{Binding CancelJobCommand}" Header="Cancel Selected Jobs"/>
                                <Separator/>
                                <MenuItem Command="{Binding JobHistoryCommand}" Header="Job History"/>
                                <Separator/>
                                <MenuItem Command="{Binding EditJobCommand}" Header="Edit Selected Jobs"/>
                                <MenuItem Command="{Binding EditScheduleCommand}" Header="Edit Selected Schedules"/>
                                <Separator/>
                                <MenuItem Command="{Binding AddJobCommand}" Header="New Job"/>
                                <Separator/>
                                <MenuItem Command="{Binding DeleteJobCommand}" Header="Delete Selected Jobs"/>
                            </ContextMenu>
                        </Setter.Value>
                    </Setter>
                    <Style.Triggers>
                        <DataTrigger Binding="{Binding State.Status}" Value="Idle">
                            <Setter Property="Background" Value="#FFFFCC"/>
                        </DataTrigger>
                        <DataTrigger Binding="{Binding Job.RunState}" Value="Disabled">
                            <Setter Property="Background" Value="#CCCCCC"/>
                        </DataTrigger>
                        <DataTrigger Binding="{Binding State.Status}" Value="Running">
                            <Setter Property="Background" Value="#CCFFCC"/>
                        </DataTrigger>
                        <DataTrigger Binding="{Binding State.Status}" Value="Misconfigured">
                            <Setter Property="Background" Value="#FFD8CC"/>
                        </DataTrigger>
                        <DataTrigger Binding="{Binding State.Status}" Value="Cancelling">
                            <Setter Property="Background" Value="#FF8888"/>
                        </DataTrigger>
                    </Style.Triggers>
                </Style>
            </DataGrid.ItemContainerStyle>
            <DataGrid.ContextMenu>
                <ContextMenu>
                    <MenuItem Header="New Job" Command="{Binding AddJobCommand}"/>
                </ContextMenu>
            </DataGrid.ContextMenu>
        </DataGrid>
    </Grid>
</base:PanelBase>
